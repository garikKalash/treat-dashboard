<app-header (refresh)="refreshData($event)"></app-header>
<div class="container">
<div id="shelter-main-data">
  <div id="shelter-name-container" class="shelter-name-container">
    <div>
      <a href="{{shelterData?.shelterLink}}">{{shelterData?.name}}</a>
      <p *ngIf="activeAnimalCount">
        <span style="font-weight: bold">Adoptable animals imported:</span> {{activeAnimalCount}}

      </p>
      <p *ngIf="usersUsedShelter">
        <span style="font-weight: bold">Users in shelter:</span> {{usersUsedShelter}}

      </p>
    </div>
  </div>
  <mat-accordion>
    <mat-expansion-panel (opened)="showComments = true"
                         (closed)="showComments = false">
      <mat-expansion-panel-header>
        <mat-panel-description>
          Comments
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div  *ngIf="shelterData?.comments?.length == 0">
        <p> No comments</p>
      </div>
      <div *ngFor="let comment of shelterData?.comments;index as indexOfelement;">
        <div style="border: 1px gray solid; border-radius: 3px">
          <div >
            <div style="float: left">
              <p>{{comment.comment}}</p>
            </div>
            <div style="float: right">
              <button mat-icon-button aria-label="Example icon button with a vertical three dot icon"
              (click)="shelterData?.comments?.splice(indexOfelement, 1); saveComments()">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
          <div style="clear:both">
            <p style="text-align: right">Created at: {{comment.createdTime?.split('T', 1)}}</p>
          </div>
        </div>
      </div>
      <mat-form-field style="width: 100%">
        <mat-label>Add a comment</mat-label>
        <textarea matInput placeholder="Your comment here..." [(ngModel)]="newComment"></textarea>
      </mat-form-field>
      <button mat-button color="primary" (click)="saveComments()">Save comment</button>

    </mat-expansion-panel>
  </mat-accordion>
  <hr>
  <div style="text-align: right">
  <mat-form-field class="example-full-width" appearance="fill">
    <mat-label>Enter a date range</mat-label>
    <mat-date-range-input [rangePicker]="picker" >
      <input matStartDate placeholder="Start date" [(ngModel)]="start"  >
      <input matEndDate placeholder="End date" [(ngModel)]="end" >
    </mat-date-range-input>
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-date-range-picker #picker>
      <mat-date-range-picker-actions>
        <button mat-button matDateRangePickerCancel>Cancel</button>
        <button mat-raised-button color="primary" matDateRangePickerApply (click)="onSubmit(start, end)">Apply</button>
      </mat-date-range-picker-actions>
    </mat-date-range-picker>
  </mat-form-field>
  </div>
  <div class="warning" *ngIf="serverError">{{serverError}}</div>
  <div id="details-id" style="font-size:2vw;">
    <div>Visitors: {{shelterData?.visitors}}</div>
    <div>Address: {{shelterData?.shelterAddress?.address1}}</div>
    <div>City: {{shelterData?.shelterAddress?.city}}</div>
    <div>Country: {{shelterData?.shelterAddress?.country}}</div>
    <div>Postal code: {{shelterData?.shelterAddress?.postcode}}</div>
  </div>
</div>
<div id="treat-data-id" style="padding-left: 9%; padding-right: 9%; margin-top: 3%; font-size:2vw;">
  <div *ngIf="shelterSentData" style="display: inline; float: right">
    <h1 style="font-size:2vw;">Sent items</h1>
    <p>Treats: {{shelterSentData?.treats}}</p>
    <p>Meals: {{shelterSentData?.meals}}</p>
    <p>Toys: {{shelterSentData?.toys}}</p>
    <p>Food grains: {{shelterSentData?.foodGrains}}</p>
  </div>
</div>
</div>

<div class="cfooter">Last sync: {{lastSync}}</div>
